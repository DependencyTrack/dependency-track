package org.dependencytrack.model.scheduled.vulnerabilities;

import java.math.BigDecimal;
import java.util.Date;
import java.util.UUID;

import org.dependencytrack.model.AnalysisState;
import org.dependencytrack.model.Finding;
import org.dependencytrack.model.Severity;
import org.dependencytrack.tasks.scanners.AnalyzerIdentity;
import org.dependencytrack.util.ScheduledUtil;
import org.junit.Assert;
import org.junit.Test;

public class VulnerabilityDetailsInfoTest {
    private final UUID projectUuid = UUID.randomUUID();
    private final Date attributedOn = new Date();
    private final Finding finding = new Finding(projectUuid, "component-uuid", "component-name", "component-group",
            "component-version", "component-purl", "component-cpe", "vuln-uuid", "vuln-source", "vuln-vulnId", "vuln-title",
            "vuln-subtitle", "vuln-description", "vuln-recommendation", Severity.HIGH, BigDecimal.valueOf(7.2), BigDecimal.valueOf(8.4), BigDecimal.valueOf(1.25), BigDecimal.valueOf(1.75), BigDecimal.valueOf(1.3),
            "0.5", "0.9", null, AnalyzerIdentity.INTERNAL_ANALYZER, attributedOn, null, "reference-url", AnalysisState.NOT_AFFECTED, true);
    
    @Test
    public void testComponentUuid() {
        var info = new VulnerabilityDetailsInfo(finding);
        Assert.assertEquals("component-uuid", info.componentUuid());
    }

    @Test
    public void testComponentName() {
        var info = new VulnerabilityDetailsInfo(finding);
        Assert.assertEquals("component-name", info.componentName());
    }

    @Test
    public void testComponentVersion() {
        var info = new VulnerabilityDetailsInfo(finding);
        Assert.assertEquals("component-version", info.componentVersion());
    }

    @Test
    public void testComponentGroup() {
        var info = new VulnerabilityDetailsInfo(finding);
        Assert.assertEquals("component-group", info.componentGroup());
    }

    @Test
    public void testVulnerabilitySource() {
        var info = new VulnerabilityDetailsInfo(finding);
        Assert.assertEquals("vuln-source", info.vulnerabilitySource());
    }

    @Test
    public void testVulnerabilityId() {
        var info = new VulnerabilityDetailsInfo(finding);
        Assert.assertEquals("vuln-vulnId", info.vulnerabilityId());
    }

    @Test
    public void testVulnerabilitySeverity() {
        var info = new VulnerabilityDetailsInfo(finding);
        Assert.assertEquals(Severity.HIGH, info.vulnerabilitySeverity());
    }

    @Test
    public void testAnalyzer() {
        var info = new VulnerabilityDetailsInfo(finding);
        Assert.assertEquals(AnalyzerIdentity.INTERNAL_ANALYZER, info.analyzer());
    }

    @Test
    public void testAttributionReferenceUrl() {
        var info = new VulnerabilityDetailsInfo(finding);
        Assert.assertEquals("reference-url", info.attributionReferenceUrl());
    }

    @Test
    public void testAttributedOn() {
        var info = new VulnerabilityDetailsInfo(finding);
        Assert.assertEquals(ScheduledUtil.getDateOrUnknownIfNull(attributedOn), info.attributedOn());
    }

    @Test
    public void testAnalysisState() {
        var info = new VulnerabilityDetailsInfo(finding);
        Assert.assertEquals(AnalysisState.NOT_AFFECTED, info.analysisState());
    }

    @Test
    public void testSuppressed() {
        var info = new VulnerabilityDetailsInfo(finding);
        Assert.assertTrue(info.suppressed());
    }
}
