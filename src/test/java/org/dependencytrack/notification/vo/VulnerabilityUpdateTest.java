package org.dependencytrack.notification.vo;

import org.dependencytrack.model.Component;
import org.dependencytrack.model.Project;
import org.dependencytrack.model.Severity;
import org.dependencytrack.model.Vulnerability;
import org.dependencytrack.model.VulnerabilityUpdateDiff;
import org.junit.Assert;
import org.junit.Test;

import java.util.ArrayList;
import java.util.HashSet;
import java.util.List;
import java.util.Set;

public class VulnerabilityUpdateTest {

    @Test
    public void testVo() {
        Vulnerability vuln = new Vulnerability();
        VulnerabilityUpdateDiff vulnDiff = new VulnerabilityUpdateDiff(Severity.UNASSIGNED, Severity.LOW);
        Component component = new Component();
        Set<Project> affectedProjects = new HashSet<>();
        VulnerabilityUpdate vo = new VulnerabilityUpdate(vuln, vulnDiff, component, affectedProjects);
        Assert.assertEquals(vuln, vo.getVulnerability());
        Assert.assertEquals(vulnDiff, vo.getVulnerabilityUpdateDiff());
        Assert.assertEquals(component, vo.getComponent());
        Assert.assertEquals(affectedProjects, vo.getAffectedProjects());
    }
}
